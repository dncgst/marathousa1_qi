install.packages(c("rgdal", "raster", "tiff", "maptools", "gtools", "mapproj", "GISTools"))
install.packages(c("spdep", "ncf", "pgirmess"))
install.packages(c("circular", "CircStats", "RFOC", "plotrix"))
install.packages(c("lattice", "ggplot2", "ggmap", "RColorBrewer", "broom"))
install.packages("knitr")
install.packages("xlsx")
install.packages("xlsx")
install.packages("rJava")
install.packages("rJava")
install.packages("xlsx")
install.packages("rgdal")
install.packages("rgdal")
install.packages("gdalUtils")
install.packages("rgdal")
install.packages("gdata")
install.packages("rgdal")
install.packages("rgdal")
install.packages("rgeos")
install.packages("~/R/heR.Misc.tar.gz", repos = NULL, type = "source")
install.packages("~/Downloads/heR.Misc.tar.gz", repos = NULL, type = "source")
install.packages("~/Downloads/heR.Misc_0.0.8.tar.gz", repos = NULL, type = "source")
install.packages("gstat")
install.packages("spatstat")
install.packages("rmarkdown")
install.packages("gdata")
install.packages("readxl")
install.packages("tiff")
install.packages("addinslist")
addinslist:::addinslistAddin()
shinyjs:::colourPickerAddin()
addinslist:::addinslistAddin()
load("~/projects/marathousa1_qi/.RData")
library(rgdal)
library(raster)
library(maptools)
library(gtools)
library(mapproj)
library(spatstat)
install.packages(c("httpuv", "spam"))
install.packages("XLConnect")
install.packages("xlsx")
load("~/projects/marathousa1_qi/.RData")
library(circular)
library(CircStats)
library(RFOC)
library(plotrix)
library(heR.Misc)
getwd()
setwd("/home/dncgst/projects/marathousa1_qi")
UA3c.fabric <- read.csv("data/UA3c.fabric.csv", header=TRUE, sep=",", skip=0)
plunge <- rad(UA3c.fabric$plunge)
bearing <- rad(UA3c.fabric$bearing)
deg(circ.summary(bearing))
r.test(bearing)
l <- c(cos(plunge)*cos(bearing))
m <- c(cos(plunge)*sin(bearing))
n <- c(sin(plunge))
b <- matrix(c(
sum(l^2),sum(l*m),sum(l*n),
sum(m*l),sum(m^2),sum(m*n),
sum(n*l),sum(n*m),sum(n^2)),
ncol=3, byrow=TRUE)
eigenvectors <- eigen(b)$vectors
dimnames(eigenvectors) <- list(c("v1","v2","v3"),c("l","m","n"))
eigenvalues <- eigen(b)$values
names(eigenvalues) <- c("λ1","λ2","λ3")
v1.plunge <- deg(asin(eigenvectors["v1","n"]))
v1.bearing <- deg(acos(eigenvectors["v1","l"]/cos(asin(eigenvectors["v1","n"]))))
v2.plunge <- deg(asin(eigenvectors["v2","n"]))
v2.bearing <- deg(acos(eigenvectors["v2","l"]/cos(asin(eigenvectors["v2","n"]))))
v3.plunge <- deg(asin(eigenvectors["v3","n"]))
v3.bearing <- deg(acos(eigenvectors["v3","l"]/cos(asin(eigenvectors["v3","n"]))))
net()
qpoint(deg(bearing), 90-deg(plunge), col=1, pch=1, cex=1)
qpoint(deg(v1.bearing), 90-deg(v1.plunge), col=4, pch=10, cex=1, lab="v1")
qpoint(deg(v2.bearing), 90-deg(v2.plunge), col=4, pch=10, cex=1, lab="v2")
qpoint(deg(v3.bearing), 90-deg(v3.plunge), col=4, pch=10, cex=1, lab="v3")
s1 <- eigenvalues["λ1"]/length(plunge)
s2 <- eigenvalues["λ2"]/length(plunge)
s3 <- eigenvalues["λ3"]/length(plunge)
UA3c.s1_s2 <- s1/s2
UA3c.s2_s3 <- s2/s3
UA3c.s1_s3 <- s1/s3
plot(log(UA3c.s2_s3),log(UA3c.s1_s2),pch=15,xlim=c(0,3),ylim=c(0,3),xlab="ln S2/S3",ylab="ln S1/S2", main="a")
abline(h=0,col="grey",lty=2)
abline(v=0,col="grey",lty=2)
abline(0,1,col="grey",lty=2)
abline(0,2,col="grey",lty=2)
abline(0,.5,col="grey",lty=2)
abline(0,5,col="grey",lty=2)
abline(0,.2,col="grey",lty=2)
text(2.95,2.8,label="K=1",col="grey",lwd=.02)
text(2.95,.12,label="K=0",col="grey",lwd=.02)
text(.2,3,label=expression(paste("K=",infinity)),col="grey",lwd=.02)
text(2.95,.75,label="K=0.2",col="grey",lwd=.02)
text(2.95,1.65,label="K=0.5",col="grey",lwd=.02)
text(.8,3,label="K=5",col="grey",lwd=.02)
text(1.7,3,label="K=2",col="grey",lwd=.02)
abline(3,-1,col="grey",lty=1)
text(1.7,1.5,label="C=3",col="grey",lwd=.02)
PlotPTsmooth(UA3c.fabric$bearing,UA3c.fabric$plunge,x=log(UA3c.s2_s3),y=log(UA3c.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
UA3c.is <- s3/s1
UA3c.el <- 1-(s2/s1)
UA3c.bs <- 1-(UA3c.is+UA3c.el)
plunge <- rad(UA4.fabric$plunge)
bearing <- rad(UA4.fabric$bearing)
plunge <- rad(UA4.fabric$plunge)
bearing <- rad(UA4.fabric$bearing)
l <- c(cos(plunge)*cos(bearing))
m <- c(cos(plunge)*sin(bearing))
n <- c(sin(plunge))
b <- matrix(c(
sum(l^2),sum(l*m),sum(l*n),
sum(m*l),sum(m^2),sum(m*n),
sum(n*l),sum(n*m),sum(n^2)),
ncol=3, byrow=TRUE)
eigenvectors <- eigen(b)$vectors
dimnames(eigenvectors) <- list(c("v1","v2","v3"),c("l","m","n"))
eigenvalues <- eigen(b)$values
names(eigenvalues) <- c("λ1","λ2","λ3")
v1.plunge <- deg(asin(eigenvectors["v1","n"]))
v1.bearing <- deg(acos(eigenvectors["v1","l"]/cos(asin(eigenvectors["v1","n"]))))
v2.plunge <- deg(asin(eigenvectors["v2","n"]))
v2.bearing <- deg(acos(eigenvectors["v2","l"]/cos(asin(eigenvectors["v2","n"]))))
v3.plunge <- deg(asin(eigenvectors["v3","n"]))
v3.bearing <- deg(acos(eigenvectors["v3","l"]/cos(asin(eigenvectors["v3","n"]))))
net()
qpoint(deg(bearing), 90-deg(plunge), col=1, pch=1, cex=1)
qpoint(deg(v1.bearing), 90-deg(v1.plunge), col=4, pch=10, cex=1, lab="v1")
qpoint(deg(v2.bearing), 90-deg(v2.plunge), col=4, pch=10, cex=1, lab="v2")
qpoint(deg(v3.bearing), 90-deg(v3.plunge), col=4, pch=10, cex=1, lab="v3")
s1 <- eigenvalues["λ1"]/length(plunge)
s2 <- eigenvalues["λ2"]/length(plunge)
s3 <- eigenvalues["λ3"]/length(plunge)
UA4.s1_s2 <- s1/s2
UA4.s2_s3 <- s2/s3
UA4.s1_s3 <- s1/s3
plot(log(UA3c.s2_s3),log(UA3c.s1_s2),pch=15,xlim=c(0,3),ylim=c(0,3),xlab="ln S2/S3",ylab="ln S1/S2", main="a")
abline(h=0,col="grey",lty=2)
abline(v=0,col="grey",lty=2)
abline(0,1,col="grey",lty=2)
abline(0,2,col="grey",lty=2)
abline(0,.5,col="grey",lty=2)
abline(0,5,col="grey",lty=2)
abline(0,.2,col="grey",lty=2)
text(2.95,2.8,label="K=1",col="grey",lwd=.02)
text(2.95,.12,label="K=0",col="grey",lwd=.02)
text(.2,3,label=expression(paste("K=",infinity)),col="grey",lwd=.02)
text(2.95,.75,label="K=0.2",col="grey",lwd=.02)
text(2.95,1.65,label="K=0.5",col="grey",lwd=.02)
text(.8,3,label="K=5",col="grey",lwd=.02)
text(1.7,3,label="K=2",col="grey",lwd=.02)
abline(3,-1,col="grey",lty=1)
text(1.7,1.5,label="C=3",col="grey",lwd=.02)
PlotPTsmooth(UA3c.fabric$bearing,UA3c.fabric$plunge,x=log(UA3c.s2_s3),y=log(UA3c.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
PlotPTsmooth(UA4.fabric$bearing,UA4.fabric$plunge,x=log(UA4.s2_s3),y=log(UA4.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
UA4.is <- s3/s1
UA4.el <- 1-(s2/s1)
UA4.bs <- 1-(UA4.is+UA4.el)
plunge <- rad(Elephas.fabric$plunge)
bearing <- rad(Elephas.fabric$bearing)
l <- c(cos(plunge)*cos(bearing))
m <- c(cos(plunge)*sin(bearing))
n <- c(sin(plunge))
b <- matrix(c(
sum(l^2),sum(l*m),sum(l*n),
sum(m*l),sum(m^2),sum(m*n),
sum(n*l),sum(n*m),sum(n^2)),
ncol=3, byrow=TRUE)
eigenvectors <- eigen(b)$vectors
dimnames(eigenvectors) <- list(c("v1","v2","v3"),c("l","m","n"))
eigenvalues <- eigen(b)$values
names(eigenvalues) <- c("λ1","λ2","λ3")
v1.plunge <- deg(asin(eigenvectors["v1","n"]))
v1.bearing <- deg(acos(eigenvectors["v1","l"]/cos(asin(eigenvectors["v1","n"]))))
v2.plunge <- deg(asin(eigenvectors["v2","n"]))
v2.bearing <- deg(acos(eigenvectors["v2","l"]/cos(asin(eigenvectors["v2","n"]))))
v3.plunge <- deg(asin(eigenvectors["v3","n"]))
v3.bearing <- deg(acos(eigenvectors["v3","l"]/cos(asin(eigenvectors["v3","n"]))))
net()
qpoint(deg(bearing), 90-deg(plunge), col=1, pch=1, cex=1)
qpoint(deg(v1.bearing), 90-deg(v1.plunge), col=4, pch=10, cex=1, lab="v1")
qpoint(deg(v2.bearing), 90-deg(v2.plunge), col=4, pch=10, cex=1, lab="v2")
qpoint(deg(v3.bearing), 90-deg(v3.plunge), col=4, pch=10, cex=1, lab="v3")
s1 <- eigenvalues["λ1"]/length(plunge)
s2 <- eigenvalues["λ2"]/length(plunge)
s3 <- eigenvalues["λ3"]/length(plunge)
E63.s1_s2 <- s1/s2
E63.s2_s3 <- s2/s3
E63.s1_s3 <- s1/s3
plot(log(UA3c.s2_s3),log(UA3c.s1_s2),pch=15,xlim=c(0,3),ylim=c(0,3),xlab="ln S2/S3",ylab="ln S1/S2", main="a")
abline(h=0,col="grey",lty=2)
abline(v=0,col="grey",lty=2)
abline(0,1,col="grey",lty=2)
abline(0,2,col="grey",lty=2)
abline(0,.5,col="grey",lty=2)
abline(0,5,col="grey",lty=2)
abline(0,.2,col="grey",lty=2)
text(2.95,2.8,label="K=1",col="grey",lwd=.02)
text(2.95,.12,label="K=0",col="grey",lwd=.02)
text(.2,3,label=expression(paste("K=",infinity)),col="grey",lwd=.02)
text(2.95,.75,label="K=0.2",col="grey",lwd=.02)
text(2.95,1.65,label="K=0.5",col="grey",lwd=.02)
text(.8,3,label="K=5",col="grey",lwd=.02)
text(1.7,3,label="K=2",col="grey",lwd=.02)
abline(3,-1,col="grey",lty=1)
text(1.7,1.5,label="C=3",col="grey",lwd=.02)
PlotPTsmooth(UA3c.fabric$bearing,UA3c.fabric$plunge,x=log(UA3c.s2_s3),y=log(UA3c.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(.8,.4,label="UA3c",col="black",lwd=.04)
PlotPTsmooth(UA4.fabric$bearing,UA4.fabric$plunge,x=log(UA4.s2_s3),y=log(UA4.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(1.9,.6,label="UA4",col="black",lwd=.04)
PlotPTsmooth(Elephas.fabric$bearing,Elephas.fabric$plunge,x=log(E63.s2_s3),y=log(E63.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(1.8,.1,label="Eleph.",col="black",lwd=.04)
E63.is <- s3/s1
E63.el <- 1-(s2/s1)
E63.bs <- 1-(E63.is+E63.el)
plunge <- rad(UB4c_clock.fabric$plunge)
bearing <- rad(UB4c_clock.fabric$bearing)
l <- c(cos(plunge)*cos(bearing))
m <- c(cos(plunge)*sin(bearing))
n <- c(sin(plunge))
b <- matrix(c(
sum(l^2),sum(l*m),sum(l*n),
sum(m*l),sum(m^2),sum(m*n),
sum(n*l),sum(n*m),sum(n^2)),
ncol=3, byrow=TRUE)
eigenvectors <- eigen(b)$vectors
dimnames(eigenvectors) <- list(c("v1","v2","v3"),c("l","m","n"))
eigenvalues <- eigen(b)$values
names(eigenvalues) <- c("λ1","λ2","λ3")
v1.plunge <- deg(asin(eigenvectors["v1","n"]))
v1.bearing <- deg(acos(eigenvectors["v1","l"]/cos(asin(eigenvectors["v1","n"]))))
v2.plunge <- deg(asin(eigenvectors["v2","n"]))
v2.bearing <- deg(acos(eigenvectors["v2","l"]/cos(asin(eigenvectors["v2","n"]))))
v3.plunge <- deg(asin(eigenvectors["v3","n"]))
v3.bearing <- deg(acos(eigenvectors["v3","l"]/cos(asin(eigenvectors["v3","n"]))))
net()
qpoint(deg(bearing), 90-deg(plunge), col=1, pch=1, cex=1)
qpoint(deg(v1.bearing), 90-deg(v1.plunge), col=4, pch=10, cex=1, lab="v1")
qpoint(deg(v2.bearing), 90-deg(v2.plunge), col=4, pch=10, cex=1, lab="v2")
qpoint(deg(v3.bearing), 90-deg(v3.plunge), col=4, pch=10, cex=1, lab="v3")
s1 <- eigenvalues["λ1"]/length(plunge)
s2 <- eigenvalues["λ2"]/length(plunge)
s3 <- eigenvalues["λ3"]/length(plunge)
UB4c_clock.s1_s2 <- s1/s2
UB4c_clock.s2_s3 <- s2/s3
UB4c_clock.s1_s3 <- s1/s3
UB4c_clock.is <- s3/s1
UB4c_clock.el <- 1-(s2/s1)
UB4c_clock.bs <- 1-(UB4c_clock.is+UB4c_clock.el)
plunge <- rad(UB4c_comp.fabric$plunge)
bearing <- rad(UB4c_comp.fabric$bearing)
l <- c(cos(plunge)*cos(bearing))
m <- c(cos(plunge)*sin(bearing))
n <- c(sin(plunge))
b <- matrix(c(
sum(l^2),sum(l*m),sum(l*n),
sum(m*l),sum(m^2),sum(m*n),
sum(n*l),sum(n*m),sum(n^2)),
ncol=3, byrow=TRUE)
eigenvectors <- eigen(b)$vectors
dimnames(eigenvectors) <- list(c("v1","v2","v3"),c("l","m","n"))
eigenvalues <- eigen(b)$values
names(eigenvalues) <- c("λ1","λ2","λ3")
v1.plunge <- deg(asin(eigenvectors["v1","n"]))
v1.bearing <- deg(acos(eigenvectors["v1","l"]/cos(asin(eigenvectors["v1","n"]))))
v2.plunge <- deg(asin(eigenvectors["v2","n"]))
v2.bearing <- deg(acos(eigenvectors["v2","l"]/cos(asin(eigenvectors["v2","n"]))))
v3.plunge <- deg(asin(eigenvectors["v3","n"]))
v3.bearing <- deg(acos(eigenvectors["v3","l"]/cos(asin(eigenvectors["v3","n"]))))
net()
qpoint(deg(bearing), 90-deg(plunge), col=1, pch=1, cex=1)
qpoint(deg(v1.bearing), 90-deg(v1.plunge), col=4, pch=10, cex=1, lab="v1")
qpoint(deg(v2.bearing), 90-deg(v2.plunge), col=4, pch=10, cex=1, lab="v2")
qpoint(deg(v3.bearing), 90-deg(v3.plunge), col=4, pch=10, cex=1, lab="v3")
s1 <- eigenvalues["λ1"]/length(plunge)
s2 <- eigenvalues["λ2"]/length(plunge)
s3 <- eigenvalues["λ3"]/length(plunge)
UB4c_comp.s1_s2 <- s1/s2
UB4c_comp.s2_s3 <- s2/s3
UB4c_comp.s1_s3 <- s1/s3
UB4c_comp.is <- s3/s1
UB4c_comp.el <- 1-(s2/s1)
UB4c_comp.bs <- 1-(UB4c_comp.is+UB4c_comp.el)
C <- as.data.frame(cbind(c(UA3c.s1_s3, UA4.s1_s3, E63.s1_s3, UB4c_clock.s1_s3, UB4c_comp.s1_s3),c(49, 38, 63, 86, 65)))
plot(log(UA3c.s2_s3),log(UA3c.s1_s2),pch=15,xlim=c(0,3),ylim=c(0,3),xlab="ln S2/S3",ylab="ln S1/S2", main="a")
abline(h=0,col="grey",lty=2)
abline(v=0,col="grey",lty=2)
abline(0,1,col="grey",lty=2)
abline(0,2,col="grey",lty=2)
abline(0,.5,col="grey",lty=2)
abline(0,5,col="grey",lty=2)
abline(0,.2,col="grey",lty=2)
text(2.95,2.8,label="K=1",col="grey",lwd=.02)
text(2.95,.12,label="K=0",col="grey",lwd=.02)
text(.2,3,label=expression(paste("K=",infinity)),col="grey",lwd=.02)
text(2.95,.75,label="K=0.2",col="grey",lwd=.02)
text(2.95,1.65,label="K=0.5",col="grey",lwd=.02)
text(.8,3,label="K=5",col="grey",lwd=.02)
text(1.7,3,label="K=2",col="grey",lwd=.02)
abline(3,-1,col="grey",lty=1)
text(1.7,1.5,label="C=3",col="grey",lwd=.02)
PlotPTsmooth(UA3c.fabric$bearing,UA3c.fabric$plunge,x=log(UA3c.s2_s3),y=log(UA3c.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(.8,.4,label="UA3c",col="black",lwd=.04)
PlotPTsmooth(UA4.fabric$bearing,UA4.fabric$plunge,x=log(UA4.s2_s3),y=log(UA4.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(1.9,.6,label="UA4",col="black",lwd=.04)
PlotPTsmooth(Elephas.fabric$bearing,Elephas.fabric$plunge,x=log(E63.s2_s3),y=log(E63.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(1.8,.1,label="Eleph.",col="black",lwd=.04)
PlotPTsmooth(UB4c_clock.fabric$bearing,UB4c_clock.fabric$plunge,x=log(UB4c_clock.s2_s3),y=log(UB4c_clock.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(.4,.02,label="UB4c (clock)",col="black",lwd=.04)
PlotPTsmooth(UB4c_comp.fabric$bearing,UB4c_comp.fabric$plunge,x=log(UB4c_comp.s2_s3),y=log(UB4c_comp.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(.5,.5,label="UB4c (comp)",col="black",lwd=.04)
text(1.45,1.65,label="WEAK <--> STRONG",col="gray",lwd=.03,srt=45,pos=1)
text(2.55,2.63,label="<-- CLUSTERS | GIRDLES -->",col="gray",lwd=.03,srt=-45,pos=1)
plot(x=s1s3_test$N, y=log(s1s3_test$X90.), type="b", col="grey", lty=2, xlim=c(0,100), xlab="Obs.", ylab="ln C", main="b")
lines(x=s1s3_test$N, y=log(s1s3_test$X95.), type="b", col="grey", lty=2, add=TRUE)
lines(x=s1s3_test$N, y=log(s1s3_test$X97.5.), type="b", col="grey", lty=2, add=TRUE)
lines(x=s1s3_test$N, y=log(s1s3_test$X99.), type="b", col="grey", lty=2, add=TRUE)
points(C$V2, log(C$V1), pch=21, bg="#a51e37", col="#a51e37", cex=2, add=TRUE)
text(10,1, label="RANDOM",col="grey", lwd=.02)
text(25,2, label="SIGNIFICANT",col="grey",lwd=.02)
text(49,1.05, label="UA3c",col="black",lwd=.02)
text(38,2.45, label="UA4",col="black", lwd=.02)
text(63,2.2, label="Eleph.",col="black", lwd=.02)
text(86,.4, label="UB4c (clock)",col="black", lwd=.02)
text(66,.95, label="UB4c (comp)",col="black", lwd=.02)
triax.plot(matrix(c(UA3c.bs,UA3c.el,UA3c.is),ncol=3,byrow=2), show.grid=TRUE, pch=16, cex.ticks=.8, cex.axis=1, axis.labels=c("","Elongation Index\n EL=1-(S2/S1)","Isotropy Index\n IS=S3/S1"), tick.labels=list(l=seq(0.1,0.9,by=0.1), r=seq(0.1,0.9,by=0.1), b=NULL)) #, main="Benn diagram")
triax.points(matrix(c(UA3c.bs,UA3c.el,UA3c.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.44,.33, label="UA3c", lwd=.02)
triax.points(matrix(c(UA4.bs,UA4.el,UA4.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.4,.11, label="UA4", lwd=.02)
triax.points(matrix(c(E63.bs,E63.el,E63.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.3,.14, label="Eleph.", lwd=.02)
triax.points(matrix(c(UB4c_clock.bs,UB4c_clock.el,UB4c_clock.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.42,.53, label="UB4c (clock)", lwd=.02)
triax.points(matrix(c(UB4c_comp.bs,UB4c_comp.el,UB4c_comp.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.48,.4, label="UB4c (comp)", lwd=.02)
text(0.5,0.9, label="isotropic")
text(-0.1,0, label="planar")
text(1.1,0, label="linear")
plot(log(UA3c.s2_s3),log(UA3c.s1_s2),pch=15,xlim=c(0,3),ylim=c(0,3),xlab="ln S2/S3",ylab="ln S1/S2", main="a")
abline(h=0,col="grey",lty=2)
abline(v=0,col="grey",lty=2)
abline(0,1,col="grey",lty=2)
abline(0,2,col="grey",lty=2)
abline(0,.5,col="grey",lty=2)
abline(0,5,col="grey",lty=2)
abline(0,.2,col="grey",lty=2)
text(2.95,2.8,label="K=1",col="grey",lwd=.02)
text(2.95,.12,label="K=0",col="grey",lwd=.02)
text(.2,3,label=expression(paste("K=",infinity)),col="grey",lwd=.02)
text(2.95,.75,label="K=0.2",col="grey",lwd=.02)
text(2.95,1.65,label="K=0.5",col="grey",lwd=.02)
text(.8,3,label="K=5",col="grey",lwd=.02)
text(1.7,3,label="K=2",col="grey",lwd=.02)
abline(3,-1,col="grey",lty=1)
text(1.7,1.5,label="C=3",col="grey",lwd=.02)
PlotPTsmooth(UA3c.fabric$bearing,UA3c.fabric$plunge,x=log(UA3c.s2_s3),y=log(UA3c.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(.8,.4,label="UA3c",col="black",lwd=.04)
text(.5,.8,label="UA3c",col="black",lwd=.04)
PlotPTsmooth(UA4.fabric$bearing,UA4.fabric$plunge,x=log(UA4.s2_s3),y=log(UA4.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(1.9,.6,label="UA4",col="black",lwd=.04)
text(1.5,.5,label="UA4",col="black",lwd=.04)
text(.5,.7,label="UA3c",col="black",lwd=.04)
text(.5,.75,label="UA3c",col="black",lwd=.04)
PlotPTsmooth(Elephas.fabric$bearing,Elephas.fabric$plunge,x=log(E63.s2_s3),y=log(E63.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(1.8,.1,label="Eleph.",col="black",lwd=.04)
text(1.3,.75,label="Eleph.",col="black",lwd=.04)
PlotPTsmooth(UB4c_clock.fabric$bearing,UB4c_clock.fabric$plunge,x=log(UB4c_clock.s2_s3),y=log(UB4c_clock.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(.4,.02,label="UB4c (clock)",col="black",lwd=.04)
PlotPTsmooth(UB4c_comp.fabric$bearing,UB4c_comp.fabric$plunge,x=log(UB4c_comp.s2_s3),y=log(UB4c_comp.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(.5,.5,label="UB4c (comp)",col="black",lwd=.04)
text(.7,.2,label="UB4c (comp)",col="black",lwd=.04)
text(.7,.02,label="UB4c (comp)",col="black",lwd=.04)
text(.8,.02,label="UB4c (comp)",col="black",lwd=.04)
text(.4,.4,label="UB4c (clock)",col="black",lwd=.04)
text(.4,.3,label="UB4c (clock)",col="black",lwd=.04)
text(.4,.35,label="UB4c (clock)",col="black",lwd=.04)
plot(x=s1s3_test$N, y=log(s1s3_test$X90.), type="b", col="grey", lty=2, xlim=c(0,100), xlab="Obs.", ylab="ln C", main="b")
lines(x=s1s3_test$N, y=log(s1s3_test$X95.), type="b", col="grey", lty=2, add=TRUE)
lines(x=s1s3_test$N, y=log(s1s3_test$X97.5.), type="b", col="grey", lty=2, add=TRUE)
lines(x=s1s3_test$N, y=log(s1s3_test$X99.), type="b", col="grey", lty=2, add=TRUE)
points(C$V2, log(C$V1), pch=21, bg="#a51e37", col="#a51e37", cex=2, add=TRUE)
text(10,1, label="RANDOM",col="grey", lwd=.02)
text(25,2, label="SIGNIFICANT",col="grey",lwd=.02)
text(49,1.05, label="UA3c",col="black",lwd=.02)
text(38,2.45, label="UA4",col="black", lwd=.02)
text(38,1.8, label="UA4",col="black", lwd=.02)
text(38,1.9, label="UA4",col="black", lwd=.02)
text(63,2.2, label="Eleph.",col="black", lwd=.02)
text(63,2, label="Eleph.",col="black", lwd=.02)
text(63,1.95, label="Eleph.",col="black", lwd=.02)
text(63,1.92, label="Eleph.",col="black", lwd=.02)
text(38,1.87, label="UA4",col="black", lwd=.02)
text(38,1.86, label="UA4",col="black", lwd=.02)
text(49,1.07, label="UA3c",col="black",lwd=.02)
text(86,.4, label="UB4c (clock)",col="black", lwd=.02)
text(86,.2, label="UB4c (clock)",col="black", lwd=.02)
text(86,.3, label="UB4c (clock)",col="black", lwd=.02)
text(86,.32, label="UB4c (clock)",col="black", lwd=.02)
text(65,.95, label="UB4c (comp)",col="black", lwd=.02)
text(65,.35, label="UB4c (comp)",col="black", lwd=.02)
text(65,.45, label="UB4c (comp)",col="black", lwd=.02)
setEPS()
#postscript("./doc/artwork/Fig5.eps", width=20, height=10)
pdf("./doc/artwork/Fig5_r.pdf", width=20, height=10)
par(mfcol=c(1,2), ps=12, cex=1, cex.main=2, cex.axis=1, cex.lab=1)
## eigenvalues ratio graph
plot(log(UA3c.s2_s3),log(UA3c.s1_s2),pch=15,xlim=c(0,3),ylim=c(0,3),xlab="ln S2/S3",ylab="ln S1/S2", main="a")
## shape parameter K=ln(S1/S2)/ln(S2/S3) ranges from 0 (uniaxial girdles) to infinite (uniaxial clusters)
abline(h=0,col="grey",lty=2)
abline(v=0,col="grey",lty=2)
abline(0,1,col="grey",lty=2)
abline(0,2,col="grey",lty=2)
abline(0,.5,col="grey",lty=2)
abline(0,5,col="grey",lty=2)
abline(0,.2,col="grey",lty=2)
text(2.95,2.8,label="K=1",col="grey",lwd=.02)
text(2.95,.12,label="K=0",col="grey",lwd=.02)
text(.2,3,label=expression(paste("K=",infinity)),col="grey",lwd=.02)
text(2.95,.75,label="K=0.2",col="grey",lwd=.02)
text(2.95,1.65,label="K=0.5",col="grey",lwd=.02)
text(.8,3,label="K=5",col="grey",lwd=.02)
text(1.7,3,label="K=2",col="grey",lwd=.02)
## complementary to the shape parameter is the parameter C=ln(S1/S3) which expresses the 'strength' of the preferred orientation in the data sample [@Woodcock1977]. Strongly organized samples have larger C and plot further from the origin of the ratio graph. A perfect uniform distribution of data would have C=0 and would plot at the origin with S1=S2=S3=1/3. Random samples will also plot close to the origin and have low C values, suggesting that this parameter might be used as a test statistic for randomness
abline(3,-1,col="grey",lty=1)
text(1.7,1.5,label="C=3",col="grey",lwd=.02)
##
PlotPTsmooth(UA3c.fabric$bearing,UA3c.fabric$plunge,x=log(UA3c.s2_s3),y=log(UA3c.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(.5,.75,label="UA3c",col="black",lwd=.04)
PlotPTsmooth(UA4.fabric$bearing,UA4.fabric$plunge,x=log(UA4.s2_s3),y=log(UA4.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(1.5,.5,label="UA4",col="black",lwd=.04)
#PlotPTsmooth(Elephas.fabric$bearing,Elephas.fabric$plunge,x=log(E.s2_s3),y=log(E.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
#text(2.1,.1,label="Eleph.",col="black",lwd=.04)
PlotPTsmooth(Elephas.fabric$bearing,Elephas.fabric$plunge,x=log(E63.s2_s3),y=log(E63.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(1.3,.75,label="Eleph.",col="black",lwd=.04)
PlotPTsmooth(UB4c_clock.fabric$bearing,UB4c_clock.fabric$plunge,x=log(UB4c_clock.s2_s3),y=log(UB4c_clock.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(.4,.35,label="UB4c (clock)",col="black",lwd=.04)
PlotPTsmooth(UB4c_comp.fabric$bearing,UB4c_comp.fabric$plunge,x=log(UB4c_comp.s2_s3),y=log(UB4c_comp.s1_s2),siz=0.1,IMAGE=TRUE,CONT=TRUE,add=TRUE)
text(.8,.02,label="UB4c (comp)",col="black",lwd=.04)
##
text(1.45,1.65,label="WEAK <--> STRONG",col="gray",lwd=.03,srt=45,pos=1)
text(2.55,2.63,label="<-- CLUSTERS | GIRDLES -->",col="gray",lwd=.03,srt=-45,pos=1)
### plot
plot(x=s1s3_test$N, y=log(s1s3_test$X90.), type="b", col="grey", lty=2, xlim=c(0,100), xlab="Obs.", ylab="ln C", main="b")
lines(x=s1s3_test$N, y=log(s1s3_test$X95.), type="b", col="grey", lty=2, add=TRUE)
lines(x=s1s3_test$N, y=log(s1s3_test$X97.5.), type="b", col="grey", lty=2, add=TRUE)
lines(x=s1s3_test$N, y=log(s1s3_test$X99.), type="b", col="grey", lty=2, add=TRUE)
points(C$V2, log(C$V1), pch=21, bg="#a51e37", col="#a51e37", cex=2, add=TRUE)
text(10,1, label="RANDOM",col="grey", lwd=.02)
text(25,2, label="SIGNIFICANT",col="grey",lwd=.02)
text(49,1.07, label="UA3c",col="black",lwd=.02)
text(38,1.86, label="UA4",col="black", lwd=.02)
text(63,1.92, label="Eleph.",col="black", lwd=.02)
text(86,.32, label="UB4c (clock)",col="black", lwd=.02)
text(65,.45, label="UB4c (comp)",col="black", lwd=.02)
dev.off()
triax.plot(matrix(c(UA3c.bs,UA3c.el,UA3c.is),ncol=3,byrow=2), show.grid=TRUE, pch=16, cex.ticks=.8, cex.axis=1, axis.labels=c("","Elongation Index\n EL=1-(S2/S1)","Isotropy Index\n IS=S3/S1"), tick.labels=list(l=seq(0.1,0.9,by=0.1), r=seq(0.1,0.9,by=0.1), b=NULL)) #, main="Benn diagram")
triax.points(matrix(c(UA3c.bs,UA3c.el,UA3c.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.44,.33, label="UA3c", lwd=.02)
text(.54,.33, label="UA3c", lwd=.02)
text(.55,.33, label="UA3c", lwd=.02)
text(.65,.33, label="UA3c", lwd=.02)
text(.6,.33, label="UA3c", lwd=.02)
triax.plot(matrix(c(UA3c.bs,UA3c.el,UA3c.is),ncol=3,byrow=2), show.grid=TRUE, pch=16, cex.ticks=.8, cex.axis=1, axis.labels=c("","Elongation Index\n EL=1-(S2/S1)","Isotropy Index\n IS=S3/S1"), tick.labels=list(l=seq(0.1,0.9,by=0.1), r=seq(0.1,0.9,by=0.1), b=NULL)) #, main="Benn diagram")
triax.points(matrix(c(UA3c.bs,UA3c.el,UA3c.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.58,.33, label="UA3c", lwd=.02)
triax.points(matrix(c(UA4.bs,UA4.el,UA4.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.4,.11, label="UA4", lwd=.02)
triax.points(matrix(c(E63.bs,E63.el,E63.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.3,.14, label="Eleph.", lwd=.02)
text(.5,.14, label="Eleph.", lwd=.02)
text(.5,.2, label="Eleph.", lwd=.02)
text(.5,.18, label="Eleph.", lwd=.02)
triax.points(matrix(c(UB4c_clock.bs,UB4c_clock.el,UB4c_clock.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.42,.53, label="UB4c (clock)", lwd=.02)
text(.42,.52, label="UB4c (clock)", lwd=.02)
text(.42,.5, label="UB4c (clock)", lwd=.02)
triax.points(matrix(c(UB4c_comp.bs,UB4c_comp.el,UB4c_comp.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.48,.4, label="UB4c (comp)", lwd=.02)
text(.48,.44, label="UB4c (comp)", lwd=.02)
setEPS()
#postscript("./doc/artwork/Fig6.eps", width=12, height=10)
pdf("./doc/artwork/Fig6_r.pdf", width=12, height=10)
par(ps=12, cex=1, cex.main=2, cex.axis=1, cex.lab=1)
# benn diagram
triax.plot(matrix(c(UA3c.bs,UA3c.el,UA3c.is),ncol=3,byrow=2), show.grid=TRUE, pch=16, cex.ticks=.8, cex.axis=1, axis.labels=c("","Elongation Index\n EL=1-(S2/S1)","Isotropy Index\n IS=S3/S1"), tick.labels=list(l=seq(0.1,0.9,by=0.1), r=seq(0.1,0.9,by=0.1), b=NULL)) #, main="Benn diagram")
triax.points(matrix(c(UA3c.bs,UA3c.el,UA3c.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.58,.33, label="UA3c", lwd=.02)
triax.points(matrix(c(UA4.bs,UA4.el,UA4.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.4,.11, label="UA4", lwd=.02)
#triax.points(matrix(c(E.bs,E.el,E.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
#text(.3,.11, label="Eleph.", lwd=.02)
triax.points(matrix(c(E63.bs,E63.el,E63.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.5,.18, label="Eleph.", lwd=.02)
triax.points(matrix(c(UB4c_clock.bs,UB4c_clock.el,UB4c_clock.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.42,.51, label="UB4c (clock)", lwd=.02)
triax.points(matrix(c(UB4c_comp.bs,UB4c_comp.el,UB4c_comp.is),ncol=3,byrow=2), pch=16, col="#a51e37", cex=2)
text(.48,.44, label="UB4c (comp)", lwd=.02)
text(0.5,0.9, label="isotropic")
text(-0.1,0, label="planar")
text(1.1,0, label="linear")
dev.off()
